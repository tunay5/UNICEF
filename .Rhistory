variables_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/codelist/",agencyID,"/latest/?format=sdmx-2.1&detail=full&references=none")
variables_page <- xml2::read_xml(variables_url)
list_1 <- list()
for(i in 1:length(category_ids)){
categ <- category_ids[i]
objects <- xml2::xml_text(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code/com:Name")))
object_ids <- xml2::xml_attr(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code")),"id")
data <- data.frame(objects, object_ids)
list_1[[i]] <- data
}
print(categories)
print(category_ids)
}
data_structure("CAP 2030")
data_structure <- function(dataflow){
data <- dataflows()
agencyID <- data[data[,1]==dataflow,3]
id <- data[data[,1]==dataflow,2]
structure_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/datastructure/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
structure_page <- xml2::read_xml(structure_url)
categories <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:ConceptIdentity/Ref")),"id")
category_ids <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:LocalRepresentation/str:Enumeration/Ref")),"id")
variables_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/codelist/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
variables_page <- xml2::read_xml(variables_url)
list_1 <- list()
for(i in 1:length(category_ids)){
categ <- category_ids[i]
objects <- xml2::xml_text(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code/com:Name")))
object_ids <- xml2::xml_attr(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code")),"id")
data <- data.frame(objects, object_ids)
list_1[[i]] <- data
}
print(categories)
print(category_ids)
}
data_structure("CAP 2030")
data_structure <- function(dataflow){
data <- dataflows()
agencyID <- data[data[,1]==dataflow,3]
id <- data[data[,1]==dataflow,2]
structure_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/datastructure/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
structure_page <- xml2::read_xml(structure_url)
categories <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:ConceptIdentity/Ref")),"id")
category_ids <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:LocalRepresentation/str:Enumeration/Ref")),"id")
variables_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/codelist/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
variables_page <- xml2::read_xml(variables_url)
list_1 <- list()
for(i in 1:length(category_ids)){
categ <- category_ids[i]
objects <- xml2::xml_text(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code/com:Name")))
object_ids <- xml2::xml_attr(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code")),"id")
data <- data.frame(objects, object_ids)
list_1[[i]] <- data
}
list_1
}
data_structure <- function(dataflow){
data <- dataflows()
agencyID <- data[data[,1]==dataflow,3]
id <- data[data[,1]==dataflow,2]
structure_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/datastructure/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
structure_page <- xml2::read_xml(structure_url)
categories <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:ConceptIdentity/Ref")),"id")
category_ids <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:LocalRepresentation/str:Enumeration/Ref")),"id")
variables_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/codelist/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
variables_page <- xml2::read_xml(variables_url)
list_1 <- list()
for(i in 1:length(category_ids)){
categ <- category_ids[i]
objects <- xml2::xml_text(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code/com:Name")))
object_ids <- xml2::xml_attr(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code")),"id")
data <- data.frame(objects, object_ids)
list_1[[i]] <- data
}
list_1
}
data_structure <- function(dataflow){
data <- dataflows()
agencyID <- data[data[,1]==dataflow,3]
id <- data[data[,1]==dataflow,2]
structure_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/datastructure/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
structure_page <- xml2::read_xml(structure_url)
categories <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:ConceptIdentity/Ref")),"id")
category_ids <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:LocalRepresentation/str:Enumeration/Ref")),"id")
variables_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/codelist/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
variables_page <- xml2::read_xml(variables_url)
list_1 <- list()
for(i in 1:length(category_ids)){
categ <- category_ids[i]
objects <- xml2::xml_text(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code/com:Name")))
object_ids <- xml2::xml_attr(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code")),"id")
data <- data.frame(objects, object_ids)
list_1[[i]] <- data
}
list_1
}
data_structure("CAP 2030")
data_structure <- function(dataflow){
data <- dataflows()
agencyID <- data[data[,1]==dataflow,3]
id <- data[data[,1]==dataflow,2]
structure_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/datastructure/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
structure_page <- xml2::read_xml(structure_url)
categories <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:ConceptIdentity/Ref")),"id")
category_ids <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:LocalRepresentation/str:Enumeration/Ref")),"id")
variables_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/codelist/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
variables_page <- xml2::read_xml(variables_url)
list_1 <- list()
for(i in 1:length(category_ids)){
categ <- category_ids[i]
objects <- xml2::xml_text(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code/com:Name")))
object_ids <- xml2::xml_attr(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code")),"id")
data <- data.frame(objects, object_ids)
list_1[[i]] <- data
}
print(category_ids)
print(categories)
}
data_structure("CAP 2030")
data_structure <- function(dataflow){
data <- dataflows()
agencyID <- data[data[,1]==dataflow,3]
id <- data[data[,1]==dataflow,2]
structure_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/datastructure/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
structure_page <- xml2::read_xml(structure_url)
categories <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:ConceptIdentity/Ref")),"id")
category_ids <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:LocalRepresentation/str:Enumeration/Ref")),"id")
variables_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/codelist/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
variables_page <- xml2::read_xml(variables_url)
list_1 <- list()
for(i in 1:length(category_ids)){
categ <- category_ids[i]
objects <- xml2::xml_text(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code/com:Name")))
object_ids <- xml2::xml_attr(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code")),"id")
data <- data.frame(objects, object_ids)
list_1[[i]] <- data
}
}
data_structure("UNICEF South Asia")
data_structure <- function(dataflow){
data <- dataflows()
agencyID <- data[data[,1]==dataflow,3]
id <- data[data[,1]==dataflow,2]
structure_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/datastructure/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
structure_page <- xml2::read_xml(structure_url)
categories <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:ConceptIdentity/Ref")),"id")
category_ids <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:LocalRepresentation/str:Enumeration/Ref")),"id")
variables_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/codelist/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
variables_page <- xml2::read_xml(variables_url)
list_1 <- list()
for(i in 1:length(category_ids)){
categ <- category_ids[i]
objects <- xml2::xml_text(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code/com:Name")))
object_ids <- xml2::xml_attr(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code")),"id")
data <- data.frame(objects, object_ids)
list_1[[i]] <- data
}
list_1
}
data_structure("UNICEF South Asia")
data_structure("CME Burundi")
asd <- data_structure("CME Burundi")
data_structure <- function(dataflow){
data <- dataflows()
agencyID <- data[data[,1]==dataflow,3]
id <- data[data[,1]==dataflow,2]
structure_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/datastructure/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
structure_page <- xml2::read_xml(structure_url)
categories <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:ConceptIdentity/Ref")),"id")
category_ids <- xml2::xml_attr(xml2::xml_find_all(structure_page, paste0("//*[@id = '",id,"']/str:DataStructureComponents/str:DimensionList/str:Dimension/str:LocalRepresentation/str:Enumeration/Ref")),"id")
variables_url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/codelist/",agencyID,"/all/latest/?format=sdmx-2.1&detail=full&references=none")
variables_page <- xml2::read_xml(variables_url)
list_1 <- list()
for(i in 1:length(category_ids)){
categ <- category_ids[i]
objects <- xml2::xml_text(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code/com:Name")))
object_ids <- xml2::xml_attr(xml2::xml_find_all(variables_page, paste0("//*[@id = '", categ, "']/str:Code")),"id")
data <- data.frame(objects, object_ids)
list_1[[i]] <- data
}
print(category_ids)
print(categories)
}
asd <- data_structure("CME Burundi")
data_structure("CME Burundi")
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflow()
agencyID <- data[data[,2]==dataflow,4]
page <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,"1.0/",filter,"?format=sdmx-compact-2.1")
asd <- xml2::xml_find_all(page, "//message:DataSet")
page
}
get_data("asd")
dataflows <- function(){
url <- "https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/dataflow/all/all/latest/?format=sdmx-2.1&detail=full&references=none"
page <- xml2::read_xml(url)
data_flow_id <- xml2::xml_attr(xml2::xml_find_all(page, "//str:Structure/Ref"),"id")
data_flow_agencyID <- xml2::xml_attr(xml2::xml_find_all(page, "//str:Dataflow"),"agencyID")
data_flow_name <- xml2::xml_text(xml2::xml_find_all(page, "//str:Dataflow/com:Name"))
dataflow <- xml2::xml_attr(xml2::xml_find_all(page, "//str:Dataflow"),"id")
data.frame(data_flow_name, dataflow, data_flow_id, data_flow_agencyID)
}
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
data <- dataflows()
View(data)
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflow()
agencyID <- data[data[,2]==dataflow,4]
page <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,"1.0/",filter,"?format=sdmx-compact-2.1")
asd <- xml2::xml_find_all(page, "//message:DataSet")
page
}
get_data(dataflow = "Brazil Country Office
")
get_data(dataflow = "Brazil Country Office")
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflows()
agencyID <- data[data[,2]==dataflow,4]
page <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,"1.0/",filter,"?format=sdmx-compact-2.1")
asd <- xml2::xml_find_all(page, "//message:DataSet")
page
}
get_data(dataflow = "Brazil Country Office")
get_data(dataflow = "Brazil Country Office")
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflows()
agencyID <- data[data[,2]==dataflow,4]
page <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,"1.0/",filter,"?format=sdmx-compact-2.1")
page
}
get_data(dataflow = "Brazil Country Office")
get_data(dataflow = "BRAZIL_CO")
get_data(dataflow = "BRAZIL_CO")
get_data(dataflow = "BRAZIL_CO")
get_data(dataflow = "BRAZIL_CO")
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflows()
agencyID <- data[data[,2]==dataflow,4]
page <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,",1.0/",filter,"?format=sdmx-compact-2.1")
page
}
get_data(dataflow = "BRAZIL_CO")
url <- "https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/BRAZIL_CO,BRAZIL_CO,1.0/all?format=sdmx-compact-2.1"
page <- xml2::read_xml(url)
xml2::xml_find_all("message:DataSet")
xml2::xml_find_all("//message:DataSet")
xml2::xml_find_all(page,"//message:DataSet")
xml2::xml_children(xml2::xml_find_all(page,"//message:DataSet"))
length(xml2::xml_children(xml2::xml_find_all(page,"//message:DataSet")))
url <- "https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/UNICEF.AFGHANISTAN_CO,AFG_CO,1.0/903763....?format=sdmx-compact-2.1"
page <- xml2::read_xml(url)
length(xml2::xml_children(xml2::xml_find_all(page,"//message:DataSet")))
xml2::xml_children(xml2::xml_find_all(page,"//message:DataSet"))
xml2::xml_find_all(page, "//message:DataSet/Series")
xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet"))
xml2::xml_find_all(page, //*)
xml2::xml_find_all(page, "//*")
dat %>%
xml_find_all("//*") %>%
purrr::map(~names(xml_attrs(.))) %>%
unlist() %>%
unique()
page %>%
xml_find_all("//*") %>%
purrr::map(~names(xml_attrs(.))) %>%
unlist() %>%
unique()
page %>%
xml2::xml_find_all("//*") %>%
purrr::map(~names(xml_attrs(.))) %>%
unlist() %>%
unique()
page |>
xml2::xml_find_all("//*") |>
purrr::map(~names(xml_attrs(.))) |>
unlist() |>
unique()
page |>
xml2::xml_find_all("//*") |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflows()
agencyID <- data[data[,2]==dataflow,4]
url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,",1.0/",filter,"?format=sdmx-compact-2.1")
page <- xml2::read_xml(url)
main <- xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet"))
list_1 <- list()
for(i in 1:length(main)){
d <- main[i]
d_child <- xml2::xml_children(d)
attr <- d |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
}
attr
}
get_data("BRAZIL_CO")
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflows()
agencyID <- data[data[,2]==dataflow,4]
url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,",1.0/",filter,"?format=sdmx-compact-2.1")
page <- xml2::read_xml(url)
main <- xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet"))
list_1 <- list()
for(i in 1:length(main)){
d <- main[i]
d_child <- xml2::xml_children(d)
attr <- d |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
}
length(main)
}
get_data("BRAZIL_CO")
url <- "https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/UNICEF.AFGHANISTAN_CO,AFG_CO,1.0/AFG.CME_MRM0...?format=sdmx-compact-2.1"
page <- xml2::read_xml(url)
attr <- page |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
asd <- xml2::xml_find_all(page, "//message:DataSet/Series")
asd
attr <- asd |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
attr
xml2::xml_attr(asd, attr[1])
xml2::xml_attr(asd, attr[2])
xml2::xml_attr(asd, attr[3])
asd
asd <- xml2::xml_children(page, "//message:DataSet"))
asd <- xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet"))
asd
asd <- xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet/Series"))
asd
attr <- asd |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
attr
xml2::xml_attr(asd, attr[3])
xml2::xml_attr(asd, attr[1])
xml2::xml_attr(asd, attr[2])
data.frame(matrix(ncol = length(attr), nrow = 3))
data.frame(matrix(ncol = length(attr), nrow = ))
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflows()
agencyID <- data[data[,2]==dataflow,4]
url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,",1.0/",filter,"?format=sdmx-compact-2.1")
page <- xml2::read_xml(url)
main <- xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet"))
list_1 <- list()
for(i in 1:length(main)){
d <- main[i]
d_child <- xml2::xml_children(d)
attr <- d |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
for(a in 1:length(attr)){
data <- data.frame(matrix(ncol = length(attr), nrow =  ))
data[,a] <- xml2::xml_attr(d, attr[a])
list_1[[i]] <- data
}
}
list_1
}
get_data("BRAZIL_CO")
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflows()
agencyID <- data[data[,2]==dataflow,4]
url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,",1.0/",filter,"?format=sdmx-compact-2.1")
page <- xml2::read_xml(url)
main <- xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet"))
list_1 <- list()
for(i in 1:length(main)){
d <- main[i]
d_child <- xml2::xml_children(d)
attr <- d |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
for(a in 1:length(attr)){
data <- data.frame(matrix(ncol = length(attr), nrow = length(d_child) ))
data[,a] <- xml2::xml_attr(d_child, attr[a])
list_1[[i]] <- data
}
}
list_1
}
get_data("BRAZIL_CO")
xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet"))
xml2::xml_children(xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet")))
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflows()
agencyID <- data[data[,2]==dataflow,4]
url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,",1.0/",filter,"?format=sdmx-compact-2.1")
page <- xml2::read_xml(url)
main <- xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet"))
list_1 <- list()
for(i in 1:length(main)){
d_child <- xml2::xml_children(main)
attr <- d |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
for(a in 1:length(attr)){
data <- data.frame(matrix(ncol = length(attr), nrow = length(d_child) ))
data[,a] <- xml2::xml_attr(d_child, attr[a])
list_1[[i]] <- data
}
}
list_1
}
get_data("BRAZIL_CO")
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflows()
agencyID <- data[data[,2]==dataflow,4]
url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,",1.0/",filter,"?format=sdmx-compact-2.1")
page <- xml2::read_xml(url)
main <- xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet"))
list_1 <- list()
for(i in 1:length(main)){
d_child <- xml2::xml_children(main)
attr <- d_child |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
for(a in 1:length(attr)){
data <- data.frame(matrix(ncol = length(attr), nrow = length(d_child) ))
data[,a] <- xml2::xml_attr(d_child, attr[a])
list_1[[i]] <- data
}
}
list_1
}
get_data("BRAZIL_CO")
asd
asd |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflows()
agencyID <- data[data[,2]==dataflow,4]
url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,",1.0/",filter,"?format=sdmx-compact-2.1")
page <- xml2::read_xml(url)
main <- xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet"))
list_1 <- list()
for(i in 1:length(main)){
d_child <- xml2::xml_children(main)
attr <- d_child |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
data <- data.frame(matrix(ncol = length(attr), nrow = length(d_child)))
for(a in 1:length(attr)){
data[,a] <- xml2::xml_attr(d_child, attr[a])
}
list_1[[i]] <- data
}
list_1
}
get_data("BRAZIL_CO")
get_data("AFG_CO")
get_data("AFG_CO", filter = c("AFG.CME_MRM0..."))
get_data <- function(dataflow, filter = "all", start = NULL, end = NULL){
data <- dataflows()
agencyID <- data[data[,2]==dataflow,4]
url <- paste0("https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/",agencyID,",",dataflow,",1.0/",filter,"?format=sdmx-compact-2.1")
page <- xml2::read_xml(url)
main <- xml2::xml_children(xml2::xml_find_all(page, "//message:DataSet"))
list_1 <- list()
for(i in 1:length(main)){
d_child <- xml2::xml_children(main)
attr <- d_child |>
purrr::map(~names(xml2::xml_attrs(.))) |>
unlist() |>
unique()
data <- data.frame(matrix(ncol = length(attr), nrow = length(d_child)))
for(a in 1:length(attr)){
data[,a] <- xml2::xml_attr(d_child, attr[a])
}
names(data) <- attr
list_1[[i]] <- data
}
list_1
}
get_data("AFG_CO", filter = c("AFG.CME_MRM0..."))
get_data("BRAZIL_CO", fi)
get_data("BRAZIL_CO", filter = c("MS..."))
get_data("BRAZIL_CO", filter = c("MS.PIM_TRAB_E_NUM.."))
get_data("BRAZIL_CO", filter = c("MS.DENGUETOTAL.."))
